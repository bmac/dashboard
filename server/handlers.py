import tornado
import tornado.web
from tornado import template
import json

from api.user import validate_api_key
from api import graph, profile

loader = template.Loader("./templates/")

class DBHandler(tornado.web.RequestHandler):
    def prepare(self):
        #action = self.request.path.split('/')[-1]
        api_key = self.get_argument('user', '')
        if not api_key:
            # Throw error.
            pass
        user = validate_api_key(api_key)
        if not user:
            # Throw error.
            pass

class DataHandler(DBHandler):
    def get(self, user):
        self.write(json.dumps(profile.read(user)))


class DashHandler(DBHandler):
    def get(self, user):
        self.render('templates/profile.html', user=user)


class UserHandler(DBHandler):
    def get(self, user, action):
        self.write(json.dumps(graph.read(user, action)))

class GraphHandler(DBHandler):
    def get(self, user):
        print user
        self.write(json.dumps("Graph"))
    def post(self):
        pass

class GitHubHandler(DBHandler):
    def get(self, user):
        d ={
        "2013-01-13" : 1,
        "2013-01-14" : 2,
        "2013-01-15" : 1,
        "2013-01-16" : 7,
        "2013-01-17" : 1,
        "2013-01-18" : 2,
        "2013-01-19" : 7,
        "2013-01-20" : 1,
        "2013-01-21" : 1,
        "2013-01-22" : 1,
        "2013-01-23" : 3,
        "2013-01-24" : 1,
        "2013-01-25" : 1,
        "2013-01-26" : 1,
        "2013-01-27" : 1,
        "2013-01-28" : 3,
        "2013-01-29" : 3,
        "2013-01-30" : 2,
        "2013-01-31" : 2,
        "2013-02-01" : 2,
        "2013-02-02" : 1,
        "2013-02-03" : 5,
        "2013-02-04" : 1,
        "2013-02-05" : 6,
        "2013-02-06" : 4,
        "2013-02-07" : 1,
        "2013-02-08" : 1,
        "2013-02-09" : 2,
        "2013-02-10" : 1,
        "2013-02-11" : 1,
        "2013-02-12" : 1,
        "2013-02-13" : 1,
        "2013-02-14" : 1,
        "2013-02-15" : 1,
        "2013-02-16" : 1,
        "2013-02-17" : 3,
        "2013-02-18" : 2,
        "2013-02-19" : 1,
        "2013-02-20" : 1,
        "2013-02-21" : 1,
        "2013-02-22" : 3,
        "2013-02-23" : 15,
        "2013-02-24" : 5,
        "2013-02-25" : 2,
        "2013-02-26" : 1,
        "2013-02-27" : 1,
        "2013-02-28" : 1,
        "2013-03-01" : 2,
        "2013-03-02" : 1,
        "2013-03-03" : 1,
        "2013-03-04" : 1,
        "2013-03-05" : 1,
        "2013-03-06" : 1,
        "2013-03-07" : 1,
        "2013-03-08" : 1,
        "2013-03-09" : 1,
        "2013-03-10" : 1,
        "2013-03-11" : 1,
        "2013-03-12" : 1,
        "2013-03-13" : 0,
        "2013-03-14" : 1,
        "2013-03-15" : 1,
        "2013-03-16" : 1,
        "2013-03-17" : 7,
        "2013-03-18" : 2,
        "2013-03-19" : 1,
        "2013-03-20" : 1,
        "2013-03-21" : 1,
        "2013-03-22" : 0,
        "2013-03-23" : 1,
        "2013-03-24" : 3,
        "2013-03-25" : 1,
        "2013-03-26" : 1,
        "2013-03-27" : 2,
        "2013-03-28" : 1,
        "2013-03-29" : 0,
        "2013-03-30" : 1,
        "2013-03-31" : 1,
        "2013-04-01" : 1,
        "2013-04-02" : 1,
        "2013-04-03" : 1,
        "2013-04-04" : 1,
        "2013-04-05" : 2,
        "2013-04-06" : 11,
        "2013-04-07" : 10,
        "2013-04-08" : 2,
        "2013-04-09" : 1,
        "2013-04-10" : 2,
        "2013-04-11" : 1,
        "2013-04-12" : 1,
        "2013-04-13" : 1,
        "2013-04-14" : 1,
        "2013-04-15" : 1,
        "2013-04-16" : 0,
        "2013-04-17" : 0,
        "2013-04-18" : 0,
        "2013-04-19" : 0,
        "2013-04-20" : 3,
        "2013-04-21" : 1,
        "2013-04-22" : 1,
        "2013-04-23" : 0,
        "2013-04-24" : 0,
        "2013-04-25" : 1,
        "2013-04-26" : 1,
        "2013-04-27" : 1,
        "2013-04-28" : 2,
        "2013-04-29" : 0,
        "2013-04-30" : 1,
        "2013-05-01" : 1,
        "2013-05-02" : 1,
        "2013-05-03" : 0,
        "2013-05-04" : 0,
        "2013-05-05" : 1,
        "2013-05-06" : 1,
        "2013-05-07" : 2,
        "2013-05-08" : 1,
        "2013-05-09" : 0,
        "2013-05-10" : 0,
        "2013-05-11" : 0,
        "2013-05-12" : 1,
        "2013-05-13" : 0,
        "2013-05-14" : 1,
        "2013-05-15" : 0,
        "2013-05-16" : 5,
        "2013-05-17" : 1,
        "2013-05-18" : 0,
        "2013-05-19" : 0,
        "2013-05-20" : 0,
        "2013-05-21" : 0,
        "2013-05-22" : 0,
        "2013-05-23" : 0,
        "2013-05-24" : 0,
        "2013-05-25" : 1,
        "2013-05-26" : 0,
        "2013-05-27" : 2,
        "2013-05-28" : 0,
        "2013-05-29" : 0,
        "2013-05-30" : 1,
        "2013-05-31" : 6,
        "2013-06-01" : 1,
        "2013-06-02" : 1,
        "2013-06-03" : 1,
        "2013-06-04" : 1,
        "2013-06-05" : 1,
        "2013-06-06" : 2,
        "2013-06-07" : 3,
        "2013-06-08" : 0,
        "2013-06-09" : 1,
        "2013-06-10" : 1,
        "2013-06-11" : 5,
        "2013-06-12" : 1,
        "2013-06-13" : 1,
        "2013-06-14" : 1,
        "2013-06-15" : 3,
        "2013-06-16" : 0,
        "2013-06-17" : 1,
        "2013-06-18" : 0,
        "2013-06-19" : 1,
        "2013-06-20" : 1,
        "2013-06-21" : 0,
        "2013-06-22" : 0,
        "2013-06-23" : 1,
        "2013-06-24" : 0,
        "2013-06-25" : 1,
        "2013-06-26" : 1,
        "2013-06-27" : 1,
        "2013-06-28" : 1,
        "2013-06-29" : 2,
        "2013-06-30" : 1,
        "2013-07-01" : 1,
        "2013-07-02" : 3,
        "2013-07-03" : 0,
        "2013-07-04" : 1,
        "2013-07-05" : 1,
        "2013-07-06" : 0,
        "2013-07-07" : 0,
        "2013-07-08" : 0,
        "2013-07-09" : 0,
        "2013-07-10" : 1,
        "2013-07-11" : 0,
        "2013-07-12" : 0,
        "2013-07-13" : 7,
        "2013-07-14" : 11,
        "2013-07-15" : 0,
        "2013-07-16" : 0,
        "2013-07-17" : 3,
        "2013-07-18" : 1,
        "2013-07-19" : 0,
        "2013-07-20" : 0,
        "2013-07-21" : 0,
        "2013-07-22" : 8,
        "2013-07-23" : 1,
        "2013-07-24" : 1,
        "2013-07-25" : 2,
        "2013-07-26" : 0,
        "2013-07-27" : 4,
        "2013-07-28" : 1,
        "2013-07-29" : 3,
        "2013-07-30" : 3,
        "2013-07-31" : 1,
        "2013-08-01" : 1,
        "2013-08-02" : 3,
        "2013-08-03" : 5,
        "2013-08-04" : 1,
        "2013-08-05" : 1,
        "2013-08-06" : 1,
        "2013-08-07" : 6,
        "2013-08-08" : 2,
        "2013-08-09" : 13,
        "2013-08-10" : 8,
        "2013-08-11" : 1,
        "2013-08-12" : 3,
        "2013-08-13" : 2,
        "2013-08-14" : 1,
        "2013-08-15" : 2,
        "2013-08-16" : 2,
        "2013-08-17" : 4,
        "2013-08-18" : 6,
        "2013-08-19" : 5,
        "2013-08-20" : 0,
        "2013-08-21" : 5,
        "2013-08-22" : 1,
        "2013-08-23" : 1,
        "2013-08-24" : 0,
        "2013-08-25" : 2,
        "2013-08-26" : 1,
        "2013-08-27" : 1,
        "2013-08-28" : 1,
        "2013-08-29" : 0,
        "2013-08-30" : 2,
        "2013-08-31" : 2,
        "2013-09-01" : 2,
        "2013-09-02" : 1,
        "2013-09-03" : 5,
        "2013-09-04" : 0,
        "2013-09-05" : 0,
        "2013-09-06" : 1,
        "2013-09-07" : 0,
        "2013-09-08" : 1,
        "2013-09-09" : 9,
        "2013-09-10" : 3,
        "2013-09-11" : 1,
        "2013-09-12" : 5,
        "2013-09-13" : 5,
        "2013-09-14" : 2,
        "2013-09-15" : 5,
        "2013-09-16" : 6,
        "2013-09-17" : 3,
        "2013-09-18" : 3,
        "2013-09-19" : 3,
        "2013-09-20" : 2,
        "2013-09-21" : 2,
        "2013-09-22" : 8,
        "2013-09-23" : 9,
        "2013-09-24" : 2,
        "2013-09-25" : 5,
        "2013-09-26" : 1,
        "2013-09-27" : 2,
        "2013-09-28" : 14,
        "2013-09-29" : 24,
        "2013-09-30" : 4,
        "2013-10-01" : 3,
        "2013-10-02" : 3,
        "2013-10-03" : 3,
        "2013-10-04" : 1,
        "2013-10-05" : 6,
        "2013-10-06" : 4,
        "2013-10-07" : 2,
        "2013-10-08" : 10,
        "2013-10-09" : 0,
        "2013-10-10" : 2,
        "2013-10-11" : 2,
        "2013-10-12" : 3,
        "2013-10-13" : 14,
        "2013-10-14" : 14,
        "2013-10-15" : 2,
        "2013-10-16" : 4,
        "2013-10-17" : 6,
        "2013-10-18" : 1,
        "2013-10-19" : 2,
        "2013-10-20" : 4,
        "2013-10-21" : 8,
        "2013-10-22" : 9,
        "2013-10-23" : 1,
        "2013-10-24" : 10,
        "2013-10-25" : 8,
        "2013-10-26" : 2,
        "2013-10-27" : 6,
        "2013-10-28" : 4,
        "2013-10-29" : 4,
        "2013-10-30" : 12,
        "2013-10-31" : 0,
        "2013-11-01" : 2,
        "2013-11-02" : 0,
        "2013-11-03" : 2,
        "2013-11-04" : 4,
        "2013-11-05" : 10,
        "2013-11-06" : 18,
        "2013-11-07" : 2,
        "2013-11-08" : 1,
        "2013-11-09" : 1,
        "2013-11-10" : 3,
        "2013-11-11" : 3,
        "2013-11-12" : 4,
        "2013-11-13" : 2,
        "2013-11-14" : 1,
        "2013-11-15" : 6,
        "2013-11-16" : 1,
        "2013-11-17" : 1,
        "2013-11-18" : 5,
        "2013-11-19" : 2,
        "2013-11-20" : 1,
        "2013-11-21" : 2,
        "2013-11-22" : 2,
        "2013-11-23" : 2,
        "2013-11-24" : 1,
        "2013-11-25" : 3,
        "2013-11-26" : 1,
        "2013-11-27" : 1,
        "2013-11-28" : 2,
        "2013-11-29" : 0,
        "2013-11-30" : 2,
        "2013-12-01" : 5,
        "2013-12-02" : 1,
        "2013-12-03" : 4,
        "2013-12-04" : 15,
        "2013-12-05" : 1,
        "2013-12-06" : 2,
        "2013-12-07" : 3,
        "2013-12-08" : 2,
        "2013-12-09" : 4,
        "2013-12-10" : 1,
        "2013-12-11" : 4,
        "2013-12-12" : 4,
        "2013-12-13" : 1,
        "2013-12-14" : 1,
        "2013-12-15" : 1,
        "2013-12-16" : 1,
        "2013-12-17" : 5,
        "2013-12-18" : 1,
        "2013-12-19" : 4,
        "2013-12-20" : 0,
        "2013-12-21" : 2,
        "2013-12-22" : 2,
        "2013-12-23" : 1,
        "2013-12-24" : 1,
        "2013-12-25" : 1,
        "2013-12-26" : 1,
        "2013-12-27" : 1,
        "2013-12-28" : 0,
        "2013-12-29" : 0,
        "2013-12-30" : 4,
        "2013-12-31" : 2,
        "2014-01-01" : 2,
        "2014-01-02" : 4,
        "2014-01-03" : 3,
        "2014-01-04" : 6,
        "2014-01-05" : 2,
        "2014-01-06" : 1,
        "2014-01-07" : 1,
        "2014-01-08" : 1,
        "2014-01-09" : 1,
        "2014-01-10" : 3,
        "2014-01-11" : 2,
        "2014-01-12" : 3,
        "2014-01-13" : 0
        }
        p = {
            "name" : "exercise",
            "data" : d
        }
        self.write(json.dumps(p))
